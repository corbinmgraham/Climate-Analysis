---
title: "DS202-FinalProject"
author: "Corbin Graham, Coleman Dimmer"
date: "2023-11-09"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# DS 201 Final Project

Corbin Graham, Coleman Dimmer

## Description

???

### Libraries

```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
```

## Dataset

Milan

### Importing Data

```{r}
data <- read_csv("milan.csv")
head(data)
```

### Data Timeframe

```{r}
min(data$DATE)
max(data$DATE)
#summary(data)
str(data)
data
```

### Data Description

The dataset we chose is monthly climate data recorded in Milan, Italy, between January 1763 and November 2008. We can use this data to analyze climate patterns. etc.

## Cleaning the Data

Drop null values, drop precipitation data

```{r}

#Grabs data and names columns to more reasonable col names. NOTE: DX and DY values are in degrees F, so changed to more accurate degrees C titles to match all other vars. 
milanClimate <- data %>%
  select(
    DATE,
    MEAN = TAVG,
    MEAN_MAX = TMAX,
    MEAN_MIN = TMIN,
    HEAT_DEG_DAYS = HTDD,
    COOL_DEG_DAYS = CLDD,
    HIGHEST_TEMP = EMXT,
    HIGHEST_DAY = EMXT_ATTRIBUTES,
    COOLEST_TEMP = EMNT,
    COOLEST_DAY = EMNT_ATTRIBUTES,
    GTE_32 = DX90,
    GTE_21 = DX70,
    GTE_00 = DX32,
    LTE_00 = DT32,
    LTE_N18 = DT00
  )

milanClimate$DATE <- lubridate::ym(milanClimate$DATE)

milanClimate$HIGHEST_DAY <- as.numeric(substr(gsub('\\D','',milanClimate$HIGHEST_DAY), nchar(gsub('\\D','',milanClimate$HIGHEST_DAY))-1, nchar(gsub('\\D','',milanClimate$HIGHEST_DAY))))

milanClimate$COOLEST_DAY <- as.numeric(substr(gsub('\\D','',milanClimate$COOLEST_DAY), nchar(gsub('\\D','',milanClimate$COOLEST_DAY))-1, nchar(gsub('\\D','',milanClimate$COOLEST_DAY))))

```

## Marginal Summaries

### Max Temperature and Minimum Temperature with Date

```{r}

subset_min <- data %>%
  filter(TAVG == min(TAVG, na.rm = TRUE)) %>%
  select(DATE, TAVG, TMIN, TMAX)
subset_min

subset_max <- data %>%
  filter(TAVG == max(TAVG, na.rm = TRUE)) %>%
  select(DATE, TAVG, TMIN, TMAX)
subset_max

subset_min_max <- bind_rows(subset_min, subset_max)
subset_min_max

ggplot(subset_min_max, aes(x=DATE, y=TAVG)) +
  geom_bar(stat="identity", fill="blue", width=0.5) +
  geom_errorbar(aes(ymin = TMIN, ymax = TMAX), width = 0.2, position = position_dodge(width = 0.5)) +
  labs(x="Date", y="Temperature (C)") +
  ggtitle("Minimum and Maximum Temperatures by Date")

```

```{r}
# Monthly averages

ggplot(data, aes(x=DATE, y=TAVG)) +
  geom_point(color='blue') +
  geom_smooth(method='lm') +
  labs(x="Date", y="Temperature (C)") +
  ggtitle("Average Temperature by Date")
```
```{r}
# Assuming data is your dataframe

# Extract year from the "date" column
new_data <- data %>%
  mutate(year = lubridate::year(DATE))

# Create a summary dataframe with yearly statistics
summary_df <- new_data %>%
  group_by(year) %>%
  summarise(
    Avg_TAVG = mean(TAVG, na.rm = TRUE),
    Min_TMIN = min(TMIN, na.rm = TRUE),
    Max_TMAX = max(TMAX, na.rm = TRUE)
  )

# Print the summary dataframe
print(summary_df)
```
